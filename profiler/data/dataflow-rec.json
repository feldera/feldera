{
  "calcite_plan": {
    "error_view": {
      "rels": [
        {
          "id": 0,
          "relOp": "LogicalTableScan",
          "table": [
            "schema",
            "feldera_error_table"
          ],
          "inputs": []
        }
      ]
    },
    "has_permission_2_e6d71768f13be1c9": {
      "rels": [
        {
          "id": 1,
          "relOp": "LogicalTableScan",
          "table": [
            "schema",
            "fact_2"
          ],
          "inputs": []
        },
        {
          "id": 2,
          "relOp": "LogicalFilter",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              },
              {
                "literal": "member",
                "type": {
                  "type": "VARCHAR",
                  "nullable": false,
                  "precision": -1
                }
              }
            ]
          },
          "inputs": [
            1
          ]
        },
        {
          "id": 3,
          "relOp": "LogicalTableScan",
          "table": [
            "schema",
            "fact_3"
          ],
          "inputs": []
        },
        {
          "id": 4,
          "relOp": "LogicalFilter",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              },
              {
                "literal": "manager",
                "type": {
                  "type": "VARCHAR",
                  "nullable": false,
                  "precision": -1
                }
              }
            ]
          },
          "inputs": [
            3
          ]
        },
        {
          "id": 5,
          "relOp": "LogicalJoin",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 0,
                "name": "$0"
              },
              {
                "input": 3,
                "name": "$3"
              }
            ]
          },
          "joinType": "inner",
          "inputs": [
            2,
            4
          ]
        },
        {
          "id": 6,
          "relOp": "LogicalProject",
          "fields": [
            "arg00",
            "arg10",
            "arg20",
            "arg0",
            "arg1",
            "arg2"
          ],
          "exprs": [
            {
              "input": 3,
              "name": "$3"
            },
            {
              "input": 4,
              "name": "$4"
            },
            {
              "input": 5,
              "name": "$5"
            },
            {
              "input": 0,
              "name": "$0"
            },
            {
              "input": 1,
              "name": "$1"
            },
            {
              "input": 2,
              "name": "$2"
            }
          ],
          "inputs": [
            5
          ]
        },
        {
          "id": 7,
          "relOp": "LogicalTableScan",
          "table": [
            "schema",
            "fact_1"
          ],
          "inputs": []
        },
        {
          "id": 8,
          "relOp": "LogicalProject",
          "fields": [
            "arg0",
            "$f0"
          ],
          "exprs": [
            {
              "input": 0,
              "name": "$0"
            },
            {
              "literal": true,
              "type": {
                "type": "BOOLEAN",
                "nullable": false
              }
            }
          ],
          "inputs": [
            7
          ]
        },
        {
          "id": 9,
          "relOp": "LogicalAggregate",
          "group": [
            0
          ],
          "aggs": [
            {
              "agg": {
                "name": "MIN",
                "kind": "MIN",
                "syntax": "FUNCTION"
              },
              "type": {
                "type": "BOOLEAN",
                "nullable": false
              },
              "distinct": false,
              "operands": [
                1
              ],
              "name": null
            }
          ],
          "inputs": [
            8
          ]
        },
        {
          "id": 10,
          "relOp": "LogicalJoin",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 2,
                "name": "$2"
              },
              {
                "input": 6,
                "name": "$6"
              }
            ]
          },
          "joinType": "left",
          "inputs": [
            6,
            9
          ]
        },
        {
          "id": 11,
          "relOp": "LogicalFilter",
          "condition": {
            "op": {
              "name": "IS NULL",
              "kind": "IS_NULL",
              "syntax": "POSTFIX"
            },
            "operands": [
              {
                "input": 7,
                "name": "$7"
              }
            ]
          },
          "inputs": [
            10
          ]
        },
        {
          "id": 12,
          "relOp": "LogicalProject",
          "fields": [
            "out0_type",
            "out0_val",
            "out1_type",
            "out1_val"
          ],
          "exprs": [
            {
              "literal": "User",
              "type": {
                "type": "VARCHAR",
                "nullable": false,
                "precision": -1
              }
            },
            {
              "input": 2,
              "name": "$2"
            },
            {
              "literal": "Foo",
              "type": {
                "type": "VARCHAR",
                "nullable": false,
                "precision": -1
              }
            },
            {
              "input": 5,
              "name": "$5"
            }
          ],
          "inputs": [
            11
          ]
        },
        {
          "id": 13,
          "relOp": "LogicalTableScan",
          "table": [
            "schema",
            "has_permission_2_e6d71768f13be1c9-decl"
          ],
          "inputs": []
        },
        {
          "id": 14,
          "relOp": "LogicalJoin",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 1,
                "name": "$1"
              },
              {
                "input": 4,
                "name": "$4"
              }
            ]
          },
          "joinType": "inner",
          "inputs": [
            13,
            4
          ]
        },
        {
          "id": 15,
          "relOp": "LogicalProject",
          "fields": [
            "arg0",
            "arg1",
            "arg2",
            "out0_type",
            "out0_val",
            "out1_type",
            "out1_val"
          ],
          "exprs": [
            {
              "input": 4,
              "name": "$4"
            },
            {
              "input": 5,
              "name": "$5"
            },
            {
              "input": 6,
              "name": "$6"
            },
            {
              "input": 0,
              "name": "$0"
            },
            {
              "input": 1,
              "name": "$1"
            },
            {
              "input": 2,
              "name": "$2"
            },
            {
              "input": 3,
              "name": "$3"
            }
          ],
          "inputs": [
            14
          ]
        },
        {
          "id": 16,
          "relOp": "LogicalJoin",
          "condition": {
            "op": {
              "name": "=",
              "kind": "EQUALS",
              "syntax": "BINARY"
            },
            "operands": [
              {
                "input": 2,
                "name": "$2"
              },
              {
                "input": 7,
                "name": "$7"
              }
            ]
          },
          "joinType": "left",
          "inputs": [
            15,
            9
          ]
        },
        {
          "id": 17,
          "relOp": "LogicalFilter",
          "condition": {
            "op": {
              "name": "IS NULL",
              "kind": "IS_NULL",
              "syntax": "POSTFIX"
            },
            "operands": [
              {
                "input": 8,
                "name": "$8"
              }
            ]
          },
          "inputs": [
            16
          ]
        },
        {
          "id": 18,
          "relOp": "LogicalProject",
          "fields": [
            "out0_type",
            "out0_val",
            "out1_type",
            "out1_val"
          ],
          "exprs": [
            {
              "literal": "User",
              "type": {
                "type": "VARCHAR",
                "nullable": false,
                "precision": -1
              }
            },
            {
              "input": 2,
              "name": "$2"
            },
            {
              "literal": "Foo",
              "type": {
                "type": "VARCHAR",
                "nullable": false,
                "precision": -1
              }
            },
            {
              "input": 6,
              "name": "$6"
            }
          ],
          "inputs": [
            17
          ]
        },
        {
          "id": 19,
          "relOp": "LogicalUnion",
          "all": false,
          "inputs": [
            12,
            18
          ]
        }
      ]
    }
  },
  "mir": {
    "s0": {
      "operation": "constant",
      "inputs": [],
      "calcite": {
        "partial": 0
      },
      "positions": [],
      "persistent_id": "8b384059bdb44ad811ab341cc5e2a59697f39aac7b463cab027b185db8105e73"
    }, "s1": {
      "operation": "source_map",
      "inputs": [],
      "table": "fact_1",
      "calcite": {
        "final": 7
      },
      "positions": [
        {"start_line_number":1,"start_column":14,"end_line_number":1,"end_column":19}
      ],
      "persistent_id": "83a85e15c8630d3441fc671c4709f1f7d0cfc2b7ab04523dbcabe890cc3d5cad"
    }, "s2": {
      "operation": "source_map",
      "inputs": [],
      "table": "fact_2",
      "calcite": {
        "final": 1
      },
      "positions": [
        {"start_line_number":5,"start_column":14,"end_line_number":5,"end_column":19}
      ],
      "persistent_id": "3cda12d5d1d044577139075781f6f8b926cde9d6a558adf3e71fe7c27a0f1f27"
    }, "s3": {
      "operation": "source_map",
      "inputs": [],
      "table": "fact_3",
      "calcite": {
        "final": 3
      },
      "positions": [
        {"start_line_number":11,"start_column":14,"end_line_number":11,"end_column":19}
      ],
      "persistent_id": "1b602714afaba7ebecd97777175155db48069aa5a4e6792de3c98e080eb4e04f"
    }, "s4": {
      "operation": "map",
      "inputs": [
        { "node": "s3", "output": 0 }
      ],
      "calcite": {
        "final": 3
      },
      "positions": [],
      "persistent_id": "1d80d44d3a5f74ab0b0ab6a028de9907112768c06ee7696bda604d23bdf3fb0e"
    }, "s5": {
      "operation": "flat_map_index",
      "inputs": [
        { "node": "s4", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "final": 4
          },{
            "partial": 5
          },{
            "partial": 10
          }]
      },
      "positions": [
        {"start_line_number":25,"start_column":7,"end_line_number":25,"end_column":42},
        {"start_line_number":11,"start_column":1,"end_line_number":16,"end_column":1}
      ],
      "persistent_id": "a5ec97fbe49272d6c8da8c633e453378f82fe70cc5c3ed39fc25299c411cd8b3"
    }, "s6": {
      "operation": "flat_map_index",
      "inputs": [
        { "node": "s4", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "final": 4
          },{
            "partial": 5
          }]
      },
      "positions": [
        {"start_line_number":25,"start_column":7,"end_line_number":25,"end_column":42},
        {"start_line_number":11,"start_column":1,"end_line_number":16,"end_column":1}
      ],
      "persistent_id": "0c12896b8dadb545643e51e39ff9e6cad96a2521051eedfec42e77569ebd2a74"
    }, "s7": {
      "operation": "flat_map_index",
      "inputs": [
        { "node": "s2", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "final": 2
          },{
            "partial": 5
          },{
            "partial": 10
          }]
      },
      "positions": [
        {"start_line_number":25,"start_column":71,"end_line_number":25,"end_column":105},
        {"start_line_number":5,"start_column":1,"end_line_number":10,"end_column":1}
      ],
      "persistent_id": "4691fd32c83dae216fc683387578d9ef9cad77a3d39e81f9b2685de53ed81a2c"
    }, "s8": {
      "operation": "join_index",
      "inputs": [
        { "node": "s7", "output": 0 },
        { "node": "s5", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "partial": 5
          },{
            "partial": 10
          }]
      },
      "positions": [],
      "persistent_id": "09e3a0743ff910daccd32c4e3c9901c1362b8235661ae769b3fd3141604c88f7"
    }, "s9": {
      "operation": "map_index",
      "inputs": [
        { "node": "s8", "output": 0 }
      ],
      "calcite": {
        "partial": 10
      },
      "positions": [],
      "persistent_id": "b583a4f796b7203f242a6853d01421c305db63dd5c6843086d8caf669b4e32d4"
    }, "s10": {
      "operation": "map_index",
      "inputs": [
        { "node": "s1", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "final": 8
          },{
            "partial": 9
          }]
      },
      "positions": [],
      "persistent_id": "7e5faeda2f225cb85b36db69b493021b2562df6ff97937c92de2fb548d2fba57"
    }, "s11": {
      "operation": "aggregate",
      "inputs": [
        { "node": "s10", "output": 0 }
      ],
      "calcite": {
        "partial": 9
      },
      "positions": [],
      "persistent_id": "01dce016e57fc992400aaa4e127d3397c66692a866f25a0ecee2c939e3b2b4b6"
    }, "s12": {
      "operation": "map_index",
      "inputs": [
        { "node": "s11", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "partial": 9
          },{
            "partial": 10
          }]
      },
      "positions": [],
      "persistent_id": "bd1af3f83d85675bad979a47097dbd68ea89da710c1895fb68f4a91fe043256f"
    }, "s13": {
      "operation": "antijoin",
      "inputs": [
        { "node": "s9", "output": 0 },
        { "node": "s12", "output": 0 }
      ],
      "calcite": {
        "partial": 10
      },
      "positions": [],
      "persistent_id": "28519132d47dd7fb051704e950463ea1d711f65a20da75ae8d052b47e7191125"
    }, "s14": {
      "operation": "map",
      "inputs": [
        { "node": "s13", "output": 0 }
      ],
      "calcite": {
        "partial": 10
      },
      "positions": [],
      "persistent_id": "3fd0d2ea0f9c3b1673a168d26b3e385d2d047fff8fd7bbd706c254ccf689f0fb"
    }, "s15": {
      "operation": "map_index",
      "inputs": [
        { "node": "s11", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "partial": 9
          },{
            "partial": 10
          }]
      },
      "positions": [],
      "persistent_id": "c1bf3e39683b4d43f192ac17eae50903fa68975a1b207118a2eab5ceb887533e"
    }, "s16": {
      "operation": "join",
      "inputs": [
        { "node": "s8", "output": 0 },
        { "node": "s15", "output": 0 }
      ],
      "calcite": {
        "partial": 10
      },
      "positions": [],
      "persistent_id": "c68100ab2cd6aff2ab5c73a789abe79d49669a5d67acbc59b46fbcef2bc8ac32"
    }, "s17": {
      "operation": "sum",
      "inputs": [
        { "node": "s16", "output": 0 },
        { "node": "s14", "output": 0 }
      ],
      "calcite": {
        "final": 10
      },
      "positions": [],
      "persistent_id": "068a6da5935007645a669f29f240b9accbd39e8207b41722a24741d7c7b83162"
    }, "s18": {
      "operation": "flat_map",
      "inputs": [
        { "node": "s17", "output": 0 }
      ],
      "calcite": {
        "seq": [
          {
            "final": 11
          },{
            "final": 12
          }]
      },
      "positions": [],
      "persistent_id": "a83e30229fae8c02548fe35af7f8a8024eab7ec74d3d844f2b2b52e720441b22"
    }, "s19": {
      "operation": "nested",
      "outputs": [
        { "node": "s36", "output": 0 }
      ],
      "s20": {
        "operation": "Z has_permission_2_e6d71768f13be1c9-decl",
        "inputs": [],
        "backedges": [{ "node": "s36", "output": 0 }],
        "calcite": {
          "final": 13
        },
        "positions": [],
        "persistent_id": "2a6b14a48c46f418786f83819c14246f3c0fb8e55320cc549fada171ba524159"
      },
      "s21": {
        "operation": "delta0",
        "inputs": [
          { "node": "s6", "output": 0 }
        ],
        "calcite": {
          "partial": 14
        },
        "positions": [],
        "persistent_id": "89ff694398d728149bfb5c10ef9f4767bb83b5bbaa5b03f9fd7f32747a7c848b"
      },
      "s22": {
        "operation": "map_index",
        "inputs": [
          { "node": "s20", "output": 0 }
        ],
        "calcite": {
          "seq": [
            {
              "partial": 14
            },{
              "partial": 16
            }]
        },
        "positions": [
          {"start_line_number":17,"start_column":1,"end_line_number":22,"end_column":1}
        ],
        "persistent_id": "6cc8efdea8c429cd89207614f9c76e6c5e265e31fc6f5a0f0aab52a724beb511"
      },
      "s23": {
        "operation": "map_index",
        "inputs": [
          { "node": "s21", "output": 0 }
        ],
        "calcite": {
          "seq": [
            {
              "partial": 14
            },{
              "partial": 16
            }]
        },
        "positions": [],
        "persistent_id": "9aa7f31af8473520edbe1e82f5f5fd6217e8aa2b932d606cd13996264e6925a1"
      },
      "s24": {
        "operation": "join_index",
        "inputs": [
          { "node": "s22", "output": 0 },
          { "node": "s23", "output": 0 }
        ],
        "calcite": {
          "seq": [
            {
              "partial": 14
            },{
              "partial": 16
            }]
        },
        "positions": [],
        "persistent_id": "e783a1af0b7e5a696cf6c10b866e02ebe501fe386b6142a89d9a42d37db2bdb0"
      },
      "s25": {
        "operation": "delta0",
        "inputs": [
          { "node": "s15", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "eb131d37e7e859cbc180a16eb824f977fbc6d72aee4baf3aba4419a35958edac"
      },
      "s26": {
        "operation": "map_index",
        "inputs": [
          { "node": "s25", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "5777d4ef5d35bccfc6c46a7f10d22cbdadab35ed6571b503ff60004379fafc4a"
      },
      "s27": {
        "operation": "join",
        "inputs": [
          { "node": "s24", "output": 0 },
          { "node": "s25", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "d059af3373a7606fd3557c24259589165ee74326de4deb617cf6f54319d9833d"
      },
      "s28": {
        "operation": "map_index",
        "inputs": [
          { "node": "s24", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "d134aef444c2f61ac3e416b6d9330035e22969e917e98002cf4087cce1c13f22"
      },
      "s29": {
        "operation": "antijoin",
        "inputs": [
          { "node": "s28", "output": 0 },
          { "node": "s26", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "d3cccc6bc2c1231353e2397d366445c39f746b86e9d06cb79e4ff354f348f2a7"
      },
      "s30": {
        "operation": "map",
        "inputs": [
          { "node": "s29", "output": 0 }
        ],
        "calcite": {
          "partial": 16
        },
        "positions": [],
        "persistent_id": "189eeda414c0a8e1b65462fd4b9fbfc4c81b6da75b143ab3c83317df024342fd"
      },
      "s31": {
        "operation": "sum",
        "inputs": [
          { "node": "s27", "output": 0 },
          { "node": "s30", "output": 0 }
        ],
        "calcite": {
          "final": 16
        },
        "positions": [],
        "persistent_id": "d4ad3a84a1e6dccb26f0cde9dbe610b7c7ff6be5e5611e3b83ff8d89a5d240ae"
      },
      "s32": {
        "operation": "flat_map",
        "inputs": [
          { "node": "s31", "output": 0 }
        ],
        "calcite": {
          "seq": [
            {
              "final": 17
            },{
              "final": 18
            }]
        },
        "positions": [],
        "persistent_id": "1ffb7229b1b8168d4b55f243a143eadc2ae6a9e97ab9ec93b9657acb94390b3f"
      },
      "s33": {
        "operation": "delta0",
        "inputs": [
          { "node": "s18", "output": 0 }
        ],
        "calcite": {
          "partial": 19
        },
        "positions": [],
        "persistent_id": "9dd0802c67cb8b4b3bb6f51249c79dd273ac5436c20de6dff6e010970d3f4f46"
      },
      "s34": {
        "operation": "sum",
        "inputs": [
          { "node": "s33", "output": 0 },
          { "node": "s32", "output": 0 }
        ],
        "calcite": {
          "partial": 19
        },
        "positions": [],
        "persistent_id": "3a4abe3aa4b4a8ec0963b41547132d4c14ac28258079ade7bc0afa0d6cd13483"
      },
      "s35": {
        "operation": "distinct",
        "inputs": [
          { "node": "s34", "output": 0 }
        ],
        "calcite": {
          "final": 19
        },
        "positions": [],
        "persistent_id": "d1efd08b00eac0b5359c944b35ac8d9068525d454a3d7ad926aa74f081e6c325"
      },
      "s36": {
        "operation": "map",
        "inputs": [
          { "node": "s35", "output": 0 }
        ],
        "calcite": {
          "partial": 19
        },
        "positions": [
          {"start_line_number":23,"start_column":1,"end_line_number":35,"end_column":1}
        ],
        "persistent_id": "315ba8ae7d2a03a99817114d1eeeb946a9d5a75a05d0d0d7a1ce705ace6424c5"
      }
    }, "s37": {
      "operation": "inspect",
      "inputs": [
        { "node": "s19", "output": 0 }
      ],
      "view": "has_permission_2_e6d71768f13be1c9",
      "calcite": {
        "final": 19
      },
      "positions": [
        {"start_line_number":23,"start_column":1,"end_line_number":35,"end_column":1}
      ],
      "persistent_id": "fe7296738d086ea07e6098e623c4c3ebfa5223585168c2c34cfed48b7eb61a9b"
    }, "s38": {
      "operation": "inspect",
      "inputs": [
        { "node": "s0", "output": 0 }
      ],
      "view": "error_view",
      "calcite": {
        "final": 0
      },
      "positions": [
        {"start_line_number":4,"start_column":1,"end_line_number":4,"end_column":59}
      ],
      "persistent_id": "933ebf782e1fe804fe85c4d0f3688bdb5234b386c2834892776e692acd9781d9"
    }
  },
  "sources": [
    "CREATE TABLE fact_1 (",
    "    arg0 text not null,",
    "    PRIMARY KEY (arg0)",
    ");",
    "CREATE TABLE fact_2 (",
    "    arg0 text not null,",
    "    arg1 text not null,",
    "    arg2 text not null,",
    "    PRIMARY KEY (arg0, arg1, arg2)",
    ");",
    "CREATE TABLE fact_3 (",
    "    arg0 text not null,",
    "    arg1 text not null,",
    "    arg2 text not null,",
    "    PRIMARY KEY (arg0, arg1, arg2)",
    ");",
    "DECLARE RECURSIVE VIEW has_permission_2_e6d71768f13be1c9(",
    "    out0_type text not null,",
    "    out0_val text not null,",
    "    out1_type text not null,",
    "    out1_val text not null",
    ");",
    "CREATE MATERIALIZED VIEW has_permission_2_e6d71768f13be1c9(out0_type, out0_val, out1_type, out1_val) as (SELECT CAST('User' as VARCHAR)  out0_type, f0.arg2 out0_val, CAST('Foo' as VARCHAR)  out1_type, f1.arg2 out1_val",
    "FROM fact_3 f0, fact_2 f1",
    "WHERE f0.arg1 = CAST('manager' as VARCHAR)  and f1.arg0 = f0.arg0 and f1.arg1 = CAST('member' as VARCHAR)  and NOT EXISTS (SELECT true",
    "FROM fact_1 f2",
    "WHERE f0.arg2 = f2.arg0",
    ")",
    " union SELECT CAST('User' as VARCHAR)  out0_type, f0.arg2 out0_val, CAST('Foo' as VARCHAR)  out1_type, t1.out1_val out1_val",
    "FROM fact_3 f0, has_permission_2_e6d71768f13be1c9 t1",
    "WHERE f0.arg1 = CAST('manager' as VARCHAR)  and t1.out0_val = f0.arg0 and NOT EXISTS (SELECT true",
    "FROM fact_1 f2",
    "WHERE f0.arg2 = f2.arg0",
    ")",
    ");"
  ]
}